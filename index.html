<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Êó•Á®ãÁÆ°ÁêÜÁ≥ªÁªü</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- SheetJSÂ∫ìÁî®‰∫éÁîüÊàêXLSÊñá‰ª∂ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <!-- ËÆ§ËØÅÈ°µÈù¢ -->
    <div id="authPage" class="auth-page">
        <div class="auth-container">
            <div class="auth-header">
                <h1>üìÖ Êó•Á®ãÁÆ°ÁêÜÁ≥ªÁªü</h1>
                <p>ÊÇ®ÁöÑÈöèË∫´Êó•Á®ãÂä©Êâã</p>
            </div>
            
            <!-- ÁôªÂΩïË°®Âçï -->
            <div id="loginFormContainer" class="auth-form-container active">
                <h2>ÁôªÂΩï</h2>
                <form id="loginForm">
                    <div class="form-group">
                        <label for="loginPhone">ÊâãÊú∫Âè∑Á†Å <span style="color: red;">*</span></label>
                        <input type="tel" id="loginPhone" placeholder="ËØ∑ËæìÂÖ•ÊâãÊú∫Âè∑Á†Å" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">ÂØÜÁ†Å <span style="color: red;">*</span></label>
                        <input type="password" id="loginPassword" placeholder="ËØ∑ËæìÂÖ•ÂØÜÁ†Å" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">
                        <i class="fas fa-sign-in-alt"></i> ÁôªÂΩï
                    </button>
                    <div class="auth-switch">
                        <p>ËøòÊ≤°ÊúâË¥¶Âè∑Ôºü <a href="#" id="showRegisterForm">Á´ãÂç≥Ê≥®ÂÜå</a></p>
                    </div>
                </form>
            </div>
            
            <!-- Ê≥®ÂÜåË°®Âçï -->
            <div id="registerFormContainer" class="auth-form-container">
                <h2>Ê≥®ÂÜå</h2>
                <form id="registerForm">
                    <div class="form-group">
                        <label for="registerUsername">Áî®Êà∑Âêç <span style="color: red;">*</span></label>
                        <input type="text" id="registerUsername" placeholder="ËØ∑ËæìÂÖ•Áî®Êà∑ÂêçÔºà2-12‰ΩçÔºâ" required minlength="2" maxlength="12">
                    </div>
                    <div class="form-group">
                        <label for="registerPhone">ÊâãÊú∫Âè∑Á†Å <span style="color: red;">*</span></label>
                        <input type="tel" id="registerPhone" placeholder="ËØ∑ËæìÂÖ•ÊâãÊú∫Âè∑Á†Å" required>
                    </div>
                    <div class="form-group">
                        <label for="registerPassword">ÂØÜÁ†Å <span style="color: red;">*</span></label>
                        <input type="password" id="registerPassword" placeholder="ËØ∑ËæìÂÖ•ÂØÜÁ†ÅÔºà6-20‰ΩçÔºâ" required minlength="6" maxlength="20">
                    </div>
                    <div class="form-group">
                        <label for="registerConfirmPassword">Á°ÆËÆ§ÂØÜÁ†Å <span style="color: red;">*</span></label>
                        <input type="password" id="registerConfirmPassword" placeholder="ËØ∑ÂÜçÊ¨°ËæìÂÖ•ÂØÜÁ†Å" required minlength="6" maxlength="20">
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">
                        <i class="fas fa-user-plus"></i> Ê≥®ÂÜå
                    </button>
                    <div class="auth-switch">
                        <p>Â∑≤ÊúâË¥¶Âè∑Ôºü <a href="#" id="showLoginForm">Á´ãÂç≥ÁôªÂΩï</a></p>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ‰∏ªÂ∫îÁî® -->
    <div id="appMain" class="app-container" style="display: none;">
        <!-- È°∂ÈÉ®ÂØºËà™ -->
        <header class="header">
            <h1>üìÖ Êó•Á®ãÁÆ°ÁêÜÁ≥ªÁªü</h1>
            <div class="header-actions">
                <div class="user-info">
                        <span id="currentUsername" style="margin-right: 1rem;"></span>
                        <span id="currentUserPhone" style="color: #666; font-size: 0.9rem;"></span>
                        <button id="editUsernameBtn" class="btn btn-sm btn-primary" title="‰øÆÊîπÁî®Êà∑Âêç">
                            <i class="fas fa-edit"></i>
                        </button>
                    </div>
                <button id="exportBtn" class="btn btn-secondary">
                    <i class="fas fa-download"></i> ÂØºÂá∫Êó•Á®ã
                </button>
                <button id="dashboardBtn" class="btn btn-primary">
                    <i class="fas fa-chart-line"></i> ‰ª™Ë°®Áõò
                </button>
                <button id="logoutBtn" class="btn btn-danger">
                    <i class="fas fa-sign-out-alt"></i> ÈÄÄÂá∫ÁôªÂΩï
                </button>
            </div>
        </header>

        <!-- ‰∏ªÂÜÖÂÆπÂå∫ -->
        <main class="main-content">
            <!-- Â∑¶‰æßÊó•ÂéÜ -->
            <div class="calendar-section">
                <div class="calendar-header">
                    <button id="prevMonth" class="btn btn-icon"><i class="fas fa-chevron-left"></i></button>
                    <h2 id="currentMonth"></h2>
                    <button id="nextMonth" class="btn btn-icon"><i class="fas fa-chevron-right"></i></button>
                </div>
                <div class="calendar-grid">
                    <div class="weekday">‰∏Ä</div>
                    <div class="weekday">‰∫å</div>
                    <div class="weekday">‰∏â</div>
                    <div class="weekday">Âõõ</div>
                    <div class="weekday">‰∫î</div>
                    <div class="weekday">ÂÖ≠</div>
                    <div class="weekday">Êó•</div>
                    <div id="calendarDays" class="days"></div>
                </div>
            </div>

            <!-- Âè≥‰æßÂÜÖÂÆπ -->
            <div class="schedule-section">
                <!-- È°∂ÈÉ®‰ø°ÊÅØÊ†è -->
                <div class="top-info-bar">
                    <!-- ÈÄâ‰∏≠Êó•Êúü‰ø°ÊÅØ -->
                    <div class="selected-date-info">
                        <h3 id="selectedDateTitle"></h3>
                    </div>
                    <!-- ÊØèÊó•ÈºìÂä±ËØ≠ -->
                    <div class="motivation-card">
                        <i class="fas fa-lightbulb"></i>
                        <p id="motivationText">‰ªäÂ§©‰πüÊòØÂÖÖÊª°Ê¥ªÂäõÁöÑ‰∏ÄÂ§©ÔºåÂä†Ê≤πÔºÅ</p>
                    </div>
                </div>

                <!-- Ê∑ªÂä†‰∫ãÈ°πË°®Âçï -->
                <div class="add-event-form">
                    <h3>Ê∑ªÂä†‰∫ãÈ°π</h3>
                    <form id="eventForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="eventName">‰∫ãÈ°πÂêçÁß∞ <span style="color: red;">*</span></label>
                                <input type="text" id="eventName" placeholder="ËæìÂÖ•‰∫ãÈ°πÂêçÁß∞" required>
                            </div>
                            <div class="form-group">
                                <label for="eventTag">‰∫ãÈ°πÊ†áÁ≠æ <span style="color: red;">*</span></label>
                                <select id="eventTag" required>
                                    <option value="Â∑•‰Ωú">Â∑•‰Ωú</option>
                                    <option value="Â≠¶‰π†">Â≠¶‰π†</option>
                                    <option value="ÁîüÊ¥ª">ÁîüÊ¥ª</option>
                                    <option value="ÂÅ•Ë∫´">ÂÅ•Ë∫´</option>
                                    <option value="ÂÖ∂‰ªñ">ÂÖ∂‰ªñ</option>
                                </select>
                                <div class="custom-tag-section" style="margin-top: 0.5rem;">
                                    <label style="font-size: 0.75rem; color: #666;">Ê∑ªÂä†Ëá™ÂÆö‰πâÊ†áÁ≠æÔºö</label>
                                    <div style="display: flex; gap: 0.5rem; margin-top: 0.25rem;">
                                        <input type="text" id="addNewTagName" placeholder="Êñ∞Ê†áÁ≠æÂêçÁß∞" style="flex: 1; padding: 0.5rem; font-size: 0.8rem;">
                                        <button type="button" id="addNewTagBtn" class="btn btn-primary" style="padding: 0.5rem;">
                                            <i class="fas fa-plus"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="startTime">ÂºÄÂßãÊó∂Èó¥</label>
                                <input type="time" id="startTime">
                            </div>
                            <div class="form-group">
                                <label for="endTime">ÁªìÊùüÊó∂Èó¥</label>
                                <input type="time" id="endTime">
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Ê∑ªÂä†‰∫ãÈ°π
                        </button>
                    </form>
                </div>

                <!-- ‰∫ãÈ°πÂàóË°® -->
                <div class="events-list">
                    <h3>‰ªäÊó•‰∫ãÈ°π</h3>
                    <div id="eventsContainer"></div>
                </div>
            </div>
        </main>

        <!-- ÁºñËæë‰∫ãÈ°πÊ®°ÊÄÅÊ°Ü -->
        <div id="editEventModal" class="modal">
            <div class="modal-content edit-modal-content">
                <div class="modal-header">
                    <h2>‚úèÔ∏è ÁºñËæë‰∫ãÈ°π</h2>
                    <button class="btn btn-icon" id="closeEditModal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="editEventForm">
                        <input type="hidden" id="editEventId">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="editEventName">‰∫ãÈ°πÂêçÁß∞ <span style="color: red;">*</span></label>
                                <input type="text" id="editEventName" placeholder="ËæìÂÖ•‰∫ãÈ°πÂêçÁß∞" required>
                            </div>
                            <div class="form-group">
                                <label for="editEventTag">‰∫ãÈ°πÊ†áÁ≠æ <span style="color: red;">*</span></label>
                                <select id="editEventTag" required>
                                    <option value="Â∑•‰Ωú">Â∑•‰Ωú</option>
                                    <option value="Â≠¶‰π†">Â≠¶‰π†</option>
                                    <option value="ÁîüÊ¥ª">ÁîüÊ¥ª</option>
                                    <option value="ÂÅ•Ë∫´">ÂÅ•Ë∫´</option>
                                    <option value="ÂÖ∂‰ªñ">ÂÖ∂‰ªñ</option>
                                </select>
                                <div class="custom-tag-section" style="margin-top: 0.5rem;">
                                    <label style="font-size: 0.75rem; color: #666;">Ê∑ªÂä†Ëá™ÂÆö‰πâÊ†áÁ≠æÔºö</label>
                                    <div style="display: flex; gap: 0.5rem; margin-top: 0.25rem;">
                                        <input type="text" id="newTagName" placeholder="Êñ∞Ê†áÁ≠æÂêçÁß∞" style="flex: 1; padding: 0.5rem; font-size: 0.8rem;">
                                        <button type="button" id="addCustomTag" class="btn btn-primary" style="padding: 0.5rem;">
                                            <i class="fas fa-plus"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="editStartTime">ÂºÄÂßãÊó∂Èó¥</label>
                                <input type="time" id="editStartTime">
                            </div>
                            <div class="form-group">
                                <label for="editEndTime">ÁªìÊùüÊó∂Èó¥</label>
                                <input type="time" id="editEndTime">
                            </div>
                        </div>
                        <div style="display: flex; gap: 1rem; justify-content: flex-end; margin-top: 1rem;">
                            <button type="button" id="cancelEdit" class="btn btn-secondary">ÂèñÊ∂à</button>
                            <button type="submit" class="btn btn-primary">‰øùÂ≠ò‰øÆÊîπ</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- ‰ª™Ë°®ÁõòÊ®°ÊÄÅÊ°Ü -->
        <div id="dashboardModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üìä Êó•Á®ã‰ª™Ë°®Áõò</h2>
                    <button class="btn btn-icon" id="closeDashboard">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="dashboard-content">
                    <div class="stat-cards">
                        <div class="stat-card">
                            <h3>ÊÄª‰∫ãÈ°πÊï∞</h3>
                            <p id="totalEvents">0</p>
                        </div>
                        <div class="stat-card">
                            <h3>Êú¨Âë®‰∫ãÈ°π</h3>
                            <p id="weekEvents">0</p>
                        </div>
                        <div class="stat-card">
                            <h3>Êú¨Êúà‰∫ãÈ°π</h3>
                            <p id="monthEvents">0</p>
                        </div>
                        <div class="stat-card">
                            <h3>Âπ≥ÂùáÊØèÂ§©</h3>
                            <p id="avgEvents">0</p>
                        </div>
                        <div class="stat-card">
                            <h3>ÊÄªÊó∂ÈïøÔºàÂ∞èÊó∂Ôºâ</h3>
                            <p id="totalHours">0</p>
                        </div>
                        <div class="stat-card">
                            <h3>Âπ≥ÂùáÊó∂Èïø/Â§©</h3>
                            <p id="avgHoursPerDay">0</p>
                        </div>
                    </div>
                    <div class="chart-section">
                        <h3>‰∫ãÈ°πÁ±ªÂûãÂàÜÂ∏É</h3>
                        <div id="tagDistribution"></div>
                    </div>
                    <div class="chart-section" style="margin-top: 1.5rem;">
                        <h3>‰∫ãÈ°πÊó∂Èó¥ÂàÜÂ∏É</h3>
                        <div id="timeDistribution"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‰øÆÊîπÁî®Êà∑ÂêçÊ®°ÊÄÅÊ°Ü -->
        <div id="editUsernameModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>‚úèÔ∏è ‰øÆÊîπÁî®Êà∑Âêç</h2>
                    <button class="btn btn-icon" id="closeEditUsernameModal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="editUsernameForm">
                        <div class="form-group">
                            <label for="newUsername">Êñ∞Áî®Êà∑Âêç <span style="color: red;">*</span></label>
                            <input type="text" id="newUsername" placeholder="ËØ∑ËæìÂÖ•Êñ∞Áî®Êà∑ÂêçÔºà2-12‰ΩçÔºâ" required minlength="2" maxlength="12">
                        </div>
                        <div style="display: flex; gap: 1rem; justify-content: flex-end; margin-top: 1rem;">
                            <button type="button" id="cancelEditUsername" class="btn btn-secondary">ÂèñÊ∂à</button>
                            <button type="submit" class="btn btn-primary">‰øùÂ≠ò‰øÆÊîπ</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>